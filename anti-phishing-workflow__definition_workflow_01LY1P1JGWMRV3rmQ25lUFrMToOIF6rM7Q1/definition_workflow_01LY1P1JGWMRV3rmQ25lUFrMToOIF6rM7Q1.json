{
  "workflow": {
    "unique_name": "definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1",
    "name": "Copy-0010 - Phishing Investigation",
    "title": "Copy-0010 - Phishing Investigation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.date",
        "properties": {
          "value": "0001-01-01T00:00:00+00:00",
          "scope": "local",
          "name": "Threat Response Token Time",
          "type": "datatype.date",
          "description": "The time at which the most recent access token was fetched from Threat Response",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J96PVT1rHpAWoB3HmZM0TEGDUGWu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Malicious Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Malicious disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Ticket Text",
          "type": "datatype.string",
          "description": "Placeholder used throughout the workflow to compile information for Threat Response casebooks and incidents",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Threat Grid Submissions",
          "type": "datatype.integer",
          "description": "How many files and URLs were submitted to Threat Grid for analysis during the investigation",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97OQ83VMfDql50Rss65dzCVukqZ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Unknown Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Unknown disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_01KXKQ1CSRGVL7ZpP6ogcjNI0ADUjMVnIl5",
        "properties": {
          "scope": "local",
          "name": "Observables Table",
          "type": "datatype.table",
          "description": "A table containing observables found during the investigation",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Observables JSON",
          "type": "datatype.string",
          "description": "Placeholder used to build a JSON list of observables found during the investigation",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97KAB3Z2MbMw91M7eyJlVUiN079",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SecureX Orchestration",
          "scope": "local",
          "name": "Webex Teams Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex Teams room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J978UB0GW0rDQ0q6ZwbIozqLSrez",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Suspicious Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Suspicious disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Clean Observables",
          "type": "datatype.integer",
          "description": "How many observables the investigation found with a Clean disposition",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Threat Grid Threat Score",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Has Email Attachment",
          "type": "datatype.boolean",
          "description": "Whether or not the email sent for investigation has an email attached to it. Since we want users to forward the suspicious email as an attachment, we check to make sure this is true after the attachments are processed",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J96VH07RBtQOCqQ4u6hdn9ztcsd2",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "someone@domain.com",
          "scope": "local",
          "name": "Notification Email Addresses",
          "type": "datatype.string",
          "description": "List of email addresses to send investigation notifications to. The email addresses should either be comma separated or each on their own line",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J9775I6CfsU185Y7RvyHW0qcUGEE",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Unknown",
          "scope": "local",
          "name": "Phish Recipients",
          "type": "datatype.string",
          "description": "The recipients of the email that was submitted for investigation. This is something we attempt to extract from the attachment headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97DS07RNMVNEN6OU9o2UHuKrjRI",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Unknown",
          "scope": "local",
          "name": "Phish Subject",
          "type": "datatype.string",
          "description": "The subject of the email that was submitted for investigation. This is something we attempt to extract from the attachment headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97FE803NSpVZIqXxDC9ocaKNzGl",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Teams Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J96TVX2AThbgEAM7oJ80DHG4cwEa",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Consolidated Headers",
          "type": "datatype.string",
          "description": "Placeholder uses to compile a list of email headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97Q8W3LXgsnYfhWBqEQfVOCvHOu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Unknown",
          "scope": "local",
          "name": "Phish Sender",
          "type": "datatype.string",
          "description": "The sender of the email that was submitted for investigation. This is something we attempt to extract from the attachment headers",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J975E40Qh11AssXDnjCRjZY0vuYd",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "SecureX Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the SecureX environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97LR8429D7D4m0prb5d8OYVfkVO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Phishing Investigation Outgoing",
          "scope": "local",
          "name": "SMTP Target Name",
          "type": "datatype.string",
          "description": "The name of the SMTP target you want to use when sending outgoing mail",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J9726O1FP0co3iXQcwxM6qJSipyj",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Access Token",
          "type": "datatype.secure_string",
          "description": "The current Threat Response access token",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97H320BJJq8BSrkJsjlg2SIHC92",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "*****",
          "scope": "local",
          "name": "Threat Grid API Key",
          "type": "datatype.secure_string",
          "description": "The API key to use with Threat Grid. You can either set this here (and remove this variable from the Fetch Global Variables activity) or you can use the Fetch Global Variables activity to update this variable with an existing API key from a global variable",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01LY1P1J97C834pQ1bAqVN4BTXoSwf7fubr",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow monitors a mailbox for incomming phishing reports. When an email is received, the workflow investigates its attachments and attempts to determine if anything in the email (or its attachments) was suspicious or malicious. If anything suspicious or malicious is found, the user is told to delete the email, a casebook and incident are created in Threat Response, a Webex Teams message is posted, and an email is sent to a \"SOC\" email address.\n\nTarget Group: Default TargetGroup\n\nTargets: CTR_API, CTR_For_Access_Token, Email Endpoint, Phishing Investigation Mailbox, Private_CTIA_Target, ThreatGrid_Target, Webex Teams\n\nSteps:\nPlease see: https://cs.co/SXO_docs",
      "display_name": "Copy-0010 - Phishing Investigation",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint",
            "email.smtp_endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01LY1PBKUL2IW1etk7wr7l2l49ApKeehyAP",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": true
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LY1PE2QY2TT0C4eGJhxfpj7cidYkKqoN1",
            "name": "Set Variables",
            "title": "Fetch global variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97C834pQ1bAqVN4BTXoSwf7fubr$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1PFBDBXXC3m3QkR26PuUQlSN9DWelUW",
        "name": "Condition Block",
        "title": "Set the environment URLs",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set the environment URLs",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LY1PGKL8SYH1GgbBPtXy3rcJioX2lS75L",
            "name": "Condition Branch",
            "title": "Prod NAM",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-nam"
              },
              "continue_on_failure": false,
              "display_name": "Prod NAM",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1PHLLX3OU1sA0xyg8fUDPA42N28WE2D",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97LR8429D7D4m0prb5d8OYVfkVO$",
                      "variable_value_new": "securex-ao.us.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$",
                      "variable_value_new": "visibility.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LY1PJC2DE936UUZzvNOVLrDZnRhCglk4T",
            "name": "Condition Branch",
            "title": "Prod EU",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-eu"
              },
              "continue_on_failure": false,
              "display_name": "Prod EU",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1PK3QLACU6ZnnSyiSediA31aqTGitQb",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97LR8429D7D4m0prb5d8OYVfkVO$",
                      "variable_value_new": "securex-ao.eu.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$",
                      "variable_value_new": "visibility.eu.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LY1PLUM6JE46DcOZRm4WDOcZFMiat1bWc",
            "name": "Condition Branch",
            "title": "Prod APJC",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-apjc"
              },
              "continue_on_failure": false,
              "display_name": "Prod APJC",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1PMMKL7J65XAcSV4mVOkfDPvMKn15Yt",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97LR8429D7D4m0prb5d8OYVfkVO$",
                      "variable_value_new": "securex-ao.apjc.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$",
                      "variable_value_new": "visibility.apjc.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LY1PNWJCJPM2ytywHVLP5axuhZZ3E4r3P",
            "name": "Condition Branch",
            "title": "INT",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "int"
              },
              "continue_on_failure": false,
              "display_name": "INT",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1PQBI7BEG7KMGgrOTUqcRNVhlQg3eMH",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97LR8429D7D4m0prb5d8OYVfkVO$",
                      "variable_value_new": "ao.int.iroh.site"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$",
                      "variable_value_new": "visibility.int.iroh.site"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1PRTEHKJC0The1oWQBCZHK8rj1K9zLF",
        "name": "For Each",
        "title": "For each attachment",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For each attachment",
          "skip_execution": false,
          "source_array": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.attachments$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LY1PTMF6MNT5WhsII8i0AMo7NMdTOeAmB",
            "name": "Condition Block",
            "title": "Is this attachment an email?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is this attachment an email?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LY1PUN3M2HJ7IIWUj0Ao6U9DW7um2Ll9E",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01LY1PRTEHKJC0The1oWQBCZHK8rj1K9zLF.input.source_array[@].is_email_type$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1PVNZ2J9P37poPUq3gi2SdyhorOXgjJ",
                    "name": "Set Variables",
                    "title": "Set local variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96VH07RBtQOCqQ4u6hdn9ztcsd2$",
                          "variable_value_new": true
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1PX63RGP045zsfBYgfzlq7UMkGq3Kn6",
        "name": "Condition Block",
        "title": "Does the email have an email attachment",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Does the email have an email attachment",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LY1PY612X6H0sEVmXiz4PD0egsbuIteZK",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96VH07RBtQOCqQ4u6hdn9ztcsd2$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1PYXTZHM37hb01prUhEQe1OZPfNEcHn",
                "name": "Send Email",
                "title": "Send user confirmation of receipt",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "Dear user-\n\nThe email you submitted for review with the subject \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\" is being processed.\n\nOnce we determine whether or not the email is safe to open, we'll get back to you.\n\nReference ID: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.instance_id$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": true,
                  "display_name": "Send user confirmation of receipt",
                  "html": false,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "Suspicious email submission received",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J9726O1FP0co3iXQcwxM6qJSipyj$"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.sender$"
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01LY1Q0O5EPTQ1KlV4Dj7oJubX74ttDjOQ7",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96VH07RBtQOCqQ4u6hdn9ztcsd2$",
                "operator": "eq",
                "right_operand": false
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1Q16ZTWQL5RJ52EKtkyiVjUOLVZz9mO",
                "name": "Send Email",
                "title": "Reply to user asking for attachment",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "Dear user-\n\nThe email you submitted for review with the subject \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\" did not contain any email attachments.\n\nPlease re-submit the suspicious email by forwarding it as an attachment or using the \"Report Suspicious Email\" button in your email client.\n\nReference ID: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.instance_id$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": false,
                  "display_name": "Reply to user asking for attachment",
                  "html": false,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "Suspicious email submission rejected",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J9726O1FP0co3iXQcwxM6qJSipyj$"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.sender$"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LY1Q3632RP15pWpHuByP6WUC16zSZkz8q",
                "name": "Group",
                "title": "Update statistics table",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update statistics table",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1Q4Q7RMB04yJLKPAflJA4VwPfxPfJQW",
                    "name": "Add Row to Table",
                    "title": "Add row to statistics table",
                    "type": "core.addrowtotable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Add row to statistics table",
                      "input_table": "$global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ.global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ$",
                      "row": [
                        {
                          "key": "observables_clean",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h$"
                        },
                        {
                          "key": "observables_suspicious",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$"
                        },
                        {
                          "key": "observables_malicious",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$"
                        },
                        {
                          "key": "observables_unknown",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6$"
                        },
                        {
                          "key": "threatgrid_submissions",
                          "type": "integer",
                          "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97OQ83VMfDql50Rss65dzCVukqZ$"
                        },
                        {
                          "key": "start_time",
                          "type": "date",
                          "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.start_time$"
                        },
                        {
                          "key": "end_time",
                          "type": "date",
                          "value": "$activity.definition_activity_01LY1Q16ZTWQL5RJ52EKtkyiVjUOLVZz9mO.output.end_time$"
                        },
                        {
                          "key": "num_attachments",
                          "type": "integer",
                          "value": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.attachments_count$"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LY1Q69KBPH036EyFD6WR4BMPLiSta30K3",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1Q7RWJMQL5uCAVXaXl3xXzgx1ItZDgv",
        "name": "Set Variables",
        "title": "Add the workflow instance ID to the ticket text",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Add the workflow instance ID to the ticket text",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
              "variable_value_new": "Workflow Instance ID: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.instance_id$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01LY1Q8U5YMVS1ELiNFivuQSaU8SJuklfDO",
        "name": "Group",
        "title": "Inspect attachments",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Inspect attachments",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO",
            "name": "For Each",
            "title": "For each attachment",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each attachment",
              "skip_execution": false,
              "source_array": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.attachments$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1QBE3GQJR419IZS80hP1iCH8XfpmjKd",
                "name": "Set Variables",
                "title": "Update ticket text and reset consolidated headers",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update ticket text and reset consolidated headers",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                      "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n\n**Processing attachment \"$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_name$\"**\n* Attachment hash: $activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97Q8W3LXgsnYfhWBqEQfVOCvHOu$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LY1QCX35P5F11cMXJEafwy5z1UWWMeF84",
                "name": "Threat Response v2 - Generate Access Token",
                "title": "Threat Response v2 - Generate Access Token",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response v2 - Generate Access Token",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "CTR_For_Access_Token"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LY1QE7C4Q711cdw2MNVHdrM9Eq4Td7Tvv",
                "name": "Set Variables",
                "title": "Update token variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Update token variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97H320BJJq8BSrkJsjlg2SIHC92$",
                      "variable_value_new": "$activity.definition_activity_01LY1QCX35P5F11cMXJEafwy5z1UWWMeF84.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96PVT1rHpAWoB3HmZM0TEGDUGWu$",
                      "variable_value_new": "$activity.definition_activity_01LY1QCX35P5F11cMXJEafwy5z1UWWMeF84.output.end_time$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01LY1QG1EQCQ52C7TCgjLxJRGbbXCBh8hVG",
                "name": "Condition Block",
                "title": "Is this attachment an email?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is this attachment an email?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LY1QHA8VU9L56s8KVX54Av59pd6AE9gDE",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].is_email_type$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1QIR5SPU43iePbby0VCilzEfM3eOokI",
                        "name": "Group",
                        "title": "Inspect email content",
                        "type": "logic.group",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Inspect email content",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LY1QKIWXHSP0htWaDnOeLGjlsniocv233",
                            "name": "Read Table from JSON",
                            "title": "Parse headers to table",
                            "type": "corejava.read_table_from_json",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Parse headers to table",
                              "input_json": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].attachment_headers$",
                              "jsonpath_query": "$.",
                              "persist_output": false,
                              "populate_columns": false,
                              "skip_execution": false,
                              "table_columns": [
                                {
                                  "column_name": "header_name",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "header_value",
                                  "column_type": "string"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LY1QMB2GDU45vDxg0BY3NRkibVf8KsYyy",
                            "name": "For Each",
                            "title": "For each header",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For each header",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01LY1QKIWXHSP0htWaDnOeLGjlsniocv233.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LY1QNUKVEKO2YmyFNlOjUxKHrkWXV47jd",
                                "name": "Set Variables",
                                "title": "Add this header's value to local variable",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Add this header's value to local variable",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97Q8W3LXgsnYfhWBqEQfVOCvHOu$",
                                      "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97Q8W3LXgsnYfhWBqEQfVOCvHOu$ $activity.definition_activity_01LY1QMB2GDU45vDxg0BY3NRkibVf8KsYyy.input.source_array[@].header_value$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LY1QPMYTBJ214JDPV9VDWKWew9YX3MWMY",
                            "name": "Threat Response v2 - Inspect for Observables",
                            "title": "Threat Response v2 - Inspect for Observables",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response v2 - Inspect for Observables",
                              "input": {
                                "variable_workflow_01KXGKYZX7V1M2gr9pVGA5BZoTbgEQPSzF1": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97H320BJJq8BSrkJsjlg2SIHC92$",
                                "variable_workflow_01KXGKYZX7ZLN1hoeZeh7hwWyjoEUkSJCbg": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].attachment_raw_body$ $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97Q8W3LXgsnYfhWBqEQfVOCvHOu$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01KXGKZ0JA96P0p7omD4IdS6zKdw5ECiofU"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LY1QREX7PUS50wHWlJYRvRH7snQLhJGwr",
                            "name": "Read Table from JSON",
                            "title": "Convert observables to table",
                            "type": "corejava.read_table_from_json",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Convert observables to table",
                              "input_json": "$activity.definition_activity_01LY1QPMYTBJ214JDPV9VDWKWew9YX3MWMY.output.variable_workflow_01KXGKYZX80T50ocjT0xlIvdikhoR0AGB5u$",
                              "jsonpath_query": "$.",
                              "persist_output": false,
                              "populate_columns": false,
                              "skip_execution": false,
                              "table_columns": [
                                {
                                  "column_name": "type",
                                  "column_type": "string"
                                },
                                {
                                  "column_name": "value",
                                  "column_type": "string"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LY1QT7I814G5yekzI1CWiLwDa4TnCj48r",
                            "name": "Set Variables",
                            "title": "Update ticket text",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Update ticket text",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                  "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Parsing attachment as an email\n* $activity.definition_activity_01LY1QKIWXHSP0htWaDnOeLGjlsniocv233.output.row_count$ email headers will be inspected\n* $activity.definition_activity_01LY1QREX7PUS50wHWlJYRvRH7snQLhJGwr.output.row_count$ observables were extracted using Threat Response"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF",
                            "name": "JSONPath Query",
                            "title": "Extract information about the email",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Extract information about the email",
                              "input_json": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].attachment_headers$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "$.[?(@.header_name==\"From\")].header_value",
                                  "jsonpath_query_name": "sender_raw",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "$.[?(@.header_name==\"Subject\")].header_value",
                                  "jsonpath_query_name": "subject",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "$.[?(@.header_name==\"To\")].header_value",
                                  "jsonpath_query_name": "recipients",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LY1QVJGFVT52UsLUhNSyKYINXERwvJnig",
                            "name": "Condition Block",
                            "title": "Were we able to extract the values?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were we able to extract the values?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LY1QWKKM9DB1f0rBN9C3PR00cb8KRPkWu",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LY1QXDWADFA1lYejWWgf7W5PyZPrxnQ8w",
                                    "name": "Match Regex",
                                    "title": "Match email regex",
                                    "type": "core.matchregex",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Match email regex",
                                      "input_regex": "(?:[a-z0-9!#$%\u0026'*+\\/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%\u0026'*+\\/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])",
                                      "input_string": "$activity.definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF.output.jsonpath_queries.sender_raw$",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01LY1QYHCI3DW2MDumicjX2dg6iLhhWuQOR",
                                    "name": "Set Variables",
                                    "title": "Set local variables",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set local variables",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J975E40Qh11AssXDnjCRjZY0vuYd$",
                                          "variable_value_new": "$activity.definition_activity_01LY1QXDWADFA1lYejWWgf7W5PyZPrxnQ8w.output.matching_strings[0]$"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97FE803NSpVZIqXxDC9ocaKNzGl$",
                                          "variable_value_new": "$activity.definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF.output.jsonpath_queries.subject$"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                          "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Sender: $activity.definition_activity_01LY1QXDWADFA1lYejWWgf7W5PyZPrxnQ8w.output.matching_strings[0]$\n* Subject: $activity.definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF.output.jsonpath_queries.subject$\n* Recipients: $activity.definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF.output.jsonpath_queries.recipients$"
                                        },
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97DS07RNMVNEN6OU9o2UHuKrjRI$",
                                          "variable_value_new": "$activity.definition_activity_01LY1QUQGE3CI5dbWtIcmz4Z4Gac7rpIzEF.output.jsonpath_queries.recipients$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ",
                            "name": "For Each",
                            "title": "For each observable",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For each observable",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01LY1QREX7PUS50wHWlJYRvRH7snQLhJGwr.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LY1R1PHA5457WaTbTbTdH2aWmZyYx8NVQ",
                                "name": "Select from Table",
                                "title": "Check if this observable already in table",
                                "type": "core.selectfromtable",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "columns": [
                                    {
                                      "column_name": "type",
                                      "column_type": "string"
                                    },
                                    {
                                      "column_name": "value",
                                      "column_type": "string"
                                    },
                                    {
                                      "column_name": "disposition",
                                      "column_type": "string"
                                    }
                                  ],
                                  "continue_on_failure": false,
                                  "display_name": "Check if this observable already in table",
                                  "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                  "number_of_rows": {
                                    "all_rows": true,
                                    "at_most": false
                                  },
                                  "persist_output": false,
                                  "skip_execution": false,
                                  "sorting": {
                                    "no_sort": true,
                                    "sort_by": false
                                  },
                                  "where_clause": "value == '$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$' AND type == '$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].type$'"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LY1R38AUMJF3ufOenACch8stWpIEXlUwZ",
                                "name": "Condition Block",
                                "title": "Is the observable already in the table?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Is the observable already in the table?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LY1R48PO8PD28T5JqyiV9BvO5bnvUXJOn",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LY1R1PHA5457WaTbTbTdH2aWmZyYx8NVQ.output.row_count$",
                                        "operator": "eq",
                                        "right_operand": 0
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1R5A8ZUP46Jr9vjQ7pExrr6NQLQyAzE",
                                        "name": "Calculate Date Time Difference",
                                        "title": "Calculate Threat Response token age",
                                        "type": "core.calculate_date_time_difference",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Calculate Threat Response token age",
                                          "original_date": "$activity.definition_activity_01LY1R1PHA5457WaTbTbTdH2aWmZyYx8NVQ.output.end_time$",
                                          "skip_execution": false,
                                          "subtract_date": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96PVT1rHpAWoB3HmZM0TEGDUGWu$"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1R716AM3Y29Vs0A8rAJ53XbsgIPRrAm",
                                        "name": "Condition Block",
                                        "title": "Does the token need to be renewed?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Does the token need to be renewed?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01LY1R828PL4P7L3OnQPpamf4k0eNb5CH1U",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01LY1R5A8ZUP46Jr9vjQ7pExrr6NQLQyAzE.output.total_minutes$",
                                                "operator": "gt",
                                                "right_operand": 8
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LY1R9M2EOHG7HpcMQp4TbfYW8egEtX97p",
                                                "name": "Threat Response v2 - Generate Access Token",
                                                "title": "Threat Response v2 - Generate Access Token",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Threat Response v2 - Generate Access Token",
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "CTR_For_Access_Token"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01LY1RAY55ORJ3IHIBFqY9f0XYjCAW00MAA",
                                                "name": "Set Variables",
                                                "title": "Update token variables",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Update token variables",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97H320BJJq8BSrkJsjlg2SIHC92$",
                                                      "variable_value_new": "$activity.definition_activity_01LY1R9M2EOHG7HpcMQp4TbfYW8egEtX97p.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                                                    },
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96PVT1rHpAWoB3HmZM0TEGDUGWu$",
                                                      "variable_value_new": "$activity.definition_activity_01LY1R9M2EOHG7HpcMQp4TbfYW8egEtX97p.output.end_time$"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1RDH0L5VK1NSVx1XU4lppScg1XmT5K0",
                                        "name": "Threat Response v2 - Get Deliberate Verdict",
                                        "title": "Threat Response v2 - Get Deliberate Verdict",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Threat Response v2 - Get Deliberate Verdict",
                                          "input": {
                                            "variable_workflow_01KXGQWL4TDTE02Mxh65PHxstnnK3wTcCF2": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97H320BJJq8BSrkJsjlg2SIHC92$",
                                            "variable_workflow_01KXGQWL4THYI5hexa4Ip4LW0UZIJhk4ejv": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].type$",
                                            "variable_workflow_01KXGQWL4TLPV5NbUAlHHHQUcco57lEijh9": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1RF9AJA9U7SOQVQv1HgYHMwZBot7W6g",
                                        "name": "Add Row to Table",
                                        "title": "Add observable to table",
                                        "type": "core.addrowtotable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": false,
                                          "display_name": "Add observable to table",
                                          "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                          "row": [
                                            {
                                              "key": "type",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].type$"
                                            },
                                            {
                                              "key": "value",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$"
                                            },
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01LY1RDH0L5VK1NSVx1XU4lppScg1XmT5K0.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1RGUA7JCR5FatkFQy1GRe7GddytiUVW",
                                        "name": "Replace String",
                                        "title": "Clean the observable",
                                        "type": "core.replacestring",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Clean the observable",
                                          "input_string": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$",
                                          "replace_list": [
                                            {
                                              "replaced_string": ".",
                                              "replacement_string": "[.]"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1RJ43AZBD249J4668W86k7Dg9KO0tiw",
                                        "name": "Set Variables",
                                        "title": "Update ticket text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update ticket text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Observable \"$activity.definition_activity_01LY1RGUA7JCR5FatkFQy1GRe7GddytiUVW.output.result_string$\" ($activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].type$) disposition: $activity.definition_activity_01LY1RDH0L5VK1NSVx1XU4lppScg1XmT5K0.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1RK6FRSHN3AsfC3kk0DVnTSajCjw3ig",
                                        "name": "Condition Block",
                                        "title": "Is the observable a URL with a 2 character TLD?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Is the observable a URL with a 2 character TLD?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01LY1RLGF7WDM43f2fsASZ2BBFmiHMfIC7G",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": {
                                                  "left_operand": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].type$",
                                                  "operator": "eqi",
                                                  "right_operand": "url"
                                                },
                                                "operator": "and",
                                                "right_operand": {
                                                  "left_operand": "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$",
                                                  "operator": "mregex",
                                                  "right_operand": "^http(s)?:\\/\\/(www\\.)?[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2}(\\/.*)?$"
                                                }
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LY1RMQ1NJZW1rJ7uHqH18yOyYG8cN0aNM",
                                                "name": "Execute Python Script",
                                                "title": "Execute GET request to the URL",
                                                "type": "python3.script",
                                                "base_type": "activity",
                                                "properties": {
                                                  "action_timeout": 180,
                                                  "continue_on_failure": false,
                                                  "display_name": "Execute GET request to the URL",
                                                  "script": "import sys,requests,re\n\n# Get the URL to request\ntestUrl = sys.argv[1]\n\n# Make sure there's no trailing HTML\nif testUrl.find(\"\u003c\") \u003e= 0:\n\ttestUrl = testUrl[0:testUrl.find(\"\u003c\")]\n\n# Request the content of the URL\nurlRequest = requests.get(testUrl, headers={ 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.3' }, allow_redirects=False)\n\n# Check if the response was a redirect\nstatusCode = urlRequest.status_code\nredirected = False\nif statusCode in [301, 302, 303, 307, 308]:\n\tredirected = True",
                                                  "script_arguments": [
                                                    "$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$"
                                                  ],
                                                  "script_queries": [
                                                    {
                                                      "script_query": "redirected",
                                                      "script_query_name": "redirected",
                                                      "script_query_type": "boolean"
                                                    },
                                                    {
                                                      "script_query": "statusCode",
                                                      "script_query_name": "statusCode",
                                                      "script_query_type": "integer"
                                                    },
                                                    {
                                                      "script_query": "testUrl",
                                                      "script_query_name": "testUrl",
                                                      "script_query_type": "string"
                                                    }
                                                  ],
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01LY1ROYB53G10O93ISju3o1SDUiCFDsPvL",
                                                "name": "Condition Block",
                                                "title": "Was there a redirect?",
                                                "type": "logic.if_else",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Was there a redirect?",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "blocks": [
                                                  {
                                                    "unique_name": "definition_activity_01LY1RPYXLSRX69qIksKqOEMPL7HUpAUXvD",
                                                    "name": "Condition Branch",
                                                    "title": "Yes",
                                                    "type": "logic.condition_block",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "condition": {
                                                        "left_operand": "$activity.definition_activity_01LY1RMQ1NJZW1rJ7uHqH18yOyYG8cN0aNM.output.script_queries.redirected$",
                                                        "operator": "eq",
                                                        "right_operand": true
                                                      },
                                                      "continue_on_failure": false,
                                                      "display_name": "Yes",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "actions": [
                                                      {
                                                        "unique_name": "definition_activity_01LY1RSZRMDJY6vC2rll6G0F7YfI9uO8wFZ",
                                                        "name": "Threat Grid v2 - Submit URL",
                                                        "title": "Threat Grid v2 - Submit URL",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": true,
                                                          "display_name": "Threat Grid v2 - Submit URL",
                                                          "input": {
                                                            "variable_workflow_01LKD7G2HMOG67VpVMWoGsGcDEi1SCYRyXh": "phishing,securex",
                                                            "variable_workflow_01LKD7G2HMRDR1Ac8bwIgGBtX9gL0UTokzl": true,
                                                            "variable_workflow_01LKD7G2HMV1S0J19LT31xAaJAkyRHFamj4": "",
                                                            "variable_workflow_01LKD7G2HMXCX3wcYatNwgUBPxLVNpT9A7K": "default",
                                                            "variable_workflow_01LKD7G2HMYI30L207he58XwfKF0NM5sIg0": true,
                                                            "variable_workflow_01LKD7G2HMZMI1JebIHwlcekUAKTtjwcc0B": 2,
                                                            "variable_workflow_01LKD7G2HN0OK1KBmsakMpLSN2QPo4CbnZ3": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97C834pQ1bAqVN4BTXoSwf7fubr$",
                                                            "variable_workflow_01LKDCRJFFFMU1yA1NdnPyw8MrMQgJYbBir": "$activity.definition_activity_01LY1RMQ1NJZW1rJ7uHqH18yOyYG8cN0aNM.output.script_queries.testUrl$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target_group_criteria": true,
                                                            "target_group": {
                                                              "run_on_all_targets": false,
                                                              "use_criteria": {
                                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                                "conditions": [
                                                                  {
                                                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                                    "operator": "eqi",
                                                                    "right_operand": "ThreatGrid_Target"
                                                                  }
                                                                ]
                                                              }
                                                            }
                                                          },
                                                          "workflow_id": "definition_workflow_01LKD7G2VQ44P3jhvJ6wDFa1EXSJdJPmv1j"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01LY1RVHWTIYH6g2ypbjpLUNnC0HALrEwlh",
                                                        "name": "Set Variables",
                                                        "title": "Update ticket text",
                                                        "type": "core.set_multiple_variables",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Update ticket text",
                                                          "skip_execution": false,
                                                          "variables_to_update": [
                                                            {
                                                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Observable was a URL, had a 2 character TLD, and responded to an HTTP GET with a 3xx redirect. Submitted to Threat Grid with sample ID: [$activity.definition_activity_01LY1RSZRMDJY6vC2rll6G0F7YfI9uO8wFZ.output.variable_workflow_01LKD7G2HMTT745KhzahqI9gFLGtN1JLDIV$](https://panacea.threatgrid.com/mask/samples/$activity.definition_activity_01LY1RSZRMDJY6vC2rll6G0F7YfI9uO8wFZ.output.variable_workflow_01LKD7G2HMTT745KhzahqI9gFLGtN1JLDIV$)"
                                                            }
                                                          ]
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01LY1RXRUZMUU2craUjp95ScCfUdQvi8lQA",
                                                        "name": "Condition Block",
                                                        "title": "Was the URL analyzed successfully?",
                                                        "type": "logic.if_else",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Was the URL analyzed successfully?",
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity",
                                                        "blocks": [
                                                          {
                                                            "unique_name": "definition_activity_01LY1RYBWNERC5IVYm0ak8M49w0RmWYBq6g",
                                                            "name": "Condition Branch",
                                                            "title": "Yes",
                                                            "type": "logic.condition_block",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "condition": {
                                                                "left_operand": "$activity.definition_activity_01LY1RSZRMDJY6vC2rll6G0F7YfI9uO8wFZ.output.succeeded$",
                                                                "operator": "eq",
                                                                "right_operand": true
                                                              },
                                                              "continue_on_failure": false,
                                                              "display_name": "Yes",
                                                              "skip_execution": false
                                                            },
                                                            "object_type": "definition_activity",
                                                            "actions": [
                                                              {
                                                                "unique_name": "definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH",
                                                                "name": "JSONPath Query",
                                                                "title": "Extract the threat score",
                                                                "type": "corejava.jsonpathquery",
                                                                "base_type": "activity",
                                                                "properties": {
                                                                  "action_timeout": 180,
                                                                  "continue_on_failure": true,
                                                                  "display_name": "Extract the threat score",
                                                                  "input_json": "$activity.definition_activity_01LY1RSZRMDJY6vC2rll6G0F7YfI9uO8wFZ.output.variable_workflow_01LKD7G2HN1TN7U91elihiN8Ygg2xHE7neU$",
                                                                  "jsonpath_queries": [
                                                                    {
                                                                      "jsonpath_query": "$.threat.threat_score",
                                                                      "jsonpath_query_name": "threat_score",
                                                                      "jsonpath_query_type": "integer"
                                                                    }
                                                                  ],
                                                                  "skip_execution": false
                                                                },
                                                                "object_type": "definition_activity"
                                                              },
                                                              {
                                                                "unique_name": "definition_activity_01LY1S1CL5GDM1eBRGWhtWCoHJfDcF2NTqg",
                                                                "name": "Condition Block",
                                                                "title": "Were we able to get a threat score?",
                                                                "type": "logic.if_else",
                                                                "base_type": "activity",
                                                                "properties": {
                                                                  "continue_on_failure": false,
                                                                  "display_name": "Were we able to get a threat score?",
                                                                  "skip_execution": false
                                                                },
                                                                "object_type": "definition_activity",
                                                                "blocks": [
                                                                  {
                                                                    "unique_name": "definition_activity_01LY1S2EE87F536VJjtic3nk3jgzVxyxIIn",
                                                                    "name": "Condition Branch",
                                                                    "title": "Yes",
                                                                    "type": "logic.condition_block",
                                                                    "base_type": "activity",
                                                                    "properties": {
                                                                      "condition": {
                                                                        "left_operand": "$activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.succeeded$",
                                                                        "operator": "eq",
                                                                        "right_operand": true
                                                                      },
                                                                      "continue_on_failure": false,
                                                                      "display_name": "Yes",
                                                                      "skip_execution": false
                                                                    },
                                                                    "object_type": "definition_activity",
                                                                    "actions": [
                                                                      {
                                                                        "unique_name": "definition_activity_01LY1S45LJE2K1G77rdBuVx1o9wFZmTyet7",
                                                                        "name": "Set Variables",
                                                                        "title": "Update ticket text",
                                                                        "type": "core.set_multiple_variables",
                                                                        "base_type": "activity",
                                                                        "properties": {
                                                                          "continue_on_failure": false,
                                                                          "display_name": "Update ticket text",
                                                                          "skip_execution": false,
                                                                          "variables_to_update": [
                                                                            {
                                                                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* URL threat score: $activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.jsonpath_queries.threat_score$"
                                                                            }
                                                                          ]
                                                                        },
                                                                        "object_type": "definition_activity"
                                                                      },
                                                                      {
                                                                        "unique_name": "definition_activity_01LY1S5F6PLRC5J7RAMzpEeVA166QWoPTmm",
                                                                        "name": "Condition Block",
                                                                        "title": "Was the file a threat?",
                                                                        "type": "logic.if_else",
                                                                        "base_type": "activity",
                                                                        "properties": {
                                                                          "continue_on_failure": false,
                                                                          "display_name": "Was the file a threat?",
                                                                          "skip_execution": false
                                                                        },
                                                                        "object_type": "definition_activity",
                                                                        "blocks": [
                                                                          {
                                                                            "unique_name": "definition_activity_01LY1S75TQU257KP81VDSS4eNm7YMylMnyv",
                                                                            "name": "Condition Branch",
                                                                            "title": "Less than 70",
                                                                            "type": "logic.condition_block",
                                                                            "base_type": "activity",
                                                                            "properties": {
                                                                              "condition": {
                                                                                "left_operand": "$activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.jsonpath_queries.threat_score$",
                                                                                "operator": "lt",
                                                                                "right_operand": 70
                                                                              },
                                                                              "continue_on_failure": false,
                                                                              "display_name": "Less than 70",
                                                                              "skip_execution": false
                                                                            },
                                                                            "object_type": "definition_activity",
                                                                            "actions": [
                                                                              {
                                                                                "unique_name": "definition_activity_01LY1S8X8IF7Q3hj0aWQoJeq43PSrJORRiJ",
                                                                                "name": "Update Row in Table",
                                                                                "title": "Update hash disposition in table",
                                                                                "type": "core.updaterowintable",
                                                                                "base_type": "activity",
                                                                                "properties": {
                                                                                  "action_timeout": 180,
                                                                                  "columns": [
                                                                                    {
                                                                                      "column_name": "disposition",
                                                                                      "column_type": "string"
                                                                                    }
                                                                                  ],
                                                                                  "continue_on_failure": false,
                                                                                  "display_name": "Update hash disposition in table",
                                                                                  "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                                                                  "row": [
                                                                                    {
                                                                                      "key": "disposition",
                                                                                      "type": "string",
                                                                                      "value": "Clean"
                                                                                    }
                                                                                  ],
                                                                                  "rows": {
                                                                                    "rows_matching_criteria": true,
                                                                                    "where_clause": "type == 'url' AND value == '$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$'"
                                                                                  },
                                                                                  "skip_execution": false
                                                                                },
                                                                                "object_type": "definition_activity"
                                                                              }
                                                                            ]
                                                                          },
                                                                          {
                                                                            "unique_name": "definition_activity_01LY1SAPBBGPP4pWWHDq0kgY31guIM9oAdo",
                                                                            "name": "Condition Branch",
                                                                            "title": "Suspicious (70-89)",
                                                                            "type": "logic.condition_block",
                                                                            "base_type": "activity",
                                                                            "properties": {
                                                                              "condition": {
                                                                                "left_operand": {
                                                                                  "left_operand": "$activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.jsonpath_queries.threat_score$",
                                                                                  "operator": "gte",
                                                                                  "right_operand": 70
                                                                                },
                                                                                "operator": "and",
                                                                                "right_operand": {
                                                                                  "left_operand": "$activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.jsonpath_queries.threat_score$",
                                                                                  "operator": "lt",
                                                                                  "right_operand": 90
                                                                                }
                                                                              },
                                                                              "continue_on_failure": false,
                                                                              "display_name": "Suspicious (70-89)",
                                                                              "skip_execution": false
                                                                            },
                                                                            "object_type": "definition_activity",
                                                                            "actions": [
                                                                              {
                                                                                "unique_name": "definition_activity_01LY1SBR12KBL0taZjr42UK4WdGQ0CizZ6S",
                                                                                "name": "Update Row in Table",
                                                                                "title": "Update hash disposition in table",
                                                                                "type": "core.updaterowintable",
                                                                                "base_type": "activity",
                                                                                "properties": {
                                                                                  "action_timeout": 180,
                                                                                  "columns": [
                                                                                    {
                                                                                      "column_name": "disposition",
                                                                                      "column_type": "string"
                                                                                    }
                                                                                  ],
                                                                                  "continue_on_failure": false,
                                                                                  "display_name": "Update hash disposition in table",
                                                                                  "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                                                                  "row": [
                                                                                    {
                                                                                      "key": "disposition",
                                                                                      "type": "string",
                                                                                      "value": "Suspicious"
                                                                                    }
                                                                                  ],
                                                                                  "rows": {
                                                                                    "rows_matching_criteria": true,
                                                                                    "where_clause": "type == 'url' AND value == '$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$'"
                                                                                  },
                                                                                  "skip_execution": false
                                                                                },
                                                                                "object_type": "definition_activity"
                                                                              }
                                                                            ]
                                                                          },
                                                                          {
                                                                            "unique_name": "definition_activity_01LY1SEGWM3JA3Wy6zHYWuR0nSypYdRIqPy",
                                                                            "name": "Condition Branch",
                                                                            "title": "Malicious (90 or more)",
                                                                            "type": "logic.condition_block",
                                                                            "base_type": "activity",
                                                                            "properties": {
                                                                              "condition": {
                                                                                "left_operand": "$activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.jsonpath_queries.threat_score$",
                                                                                "operator": "gte",
                                                                                "right_operand": 90
                                                                              },
                                                                              "continue_on_failure": false,
                                                                              "display_name": "Malicious (90 or more)",
                                                                              "skip_execution": false
                                                                            },
                                                                            "object_type": "definition_activity",
                                                                            "actions": [
                                                                              {
                                                                                "unique_name": "definition_activity_01LY1SG08QY2F5MseIJDITb7iX9xv3G0DNV",
                                                                                "name": "Update Row in Table",
                                                                                "title": "Update hash disposition in table",
                                                                                "type": "core.updaterowintable",
                                                                                "base_type": "activity",
                                                                                "properties": {
                                                                                  "action_timeout": 180,
                                                                                  "columns": [
                                                                                    {
                                                                                      "column_name": "disposition",
                                                                                      "column_type": "string"
                                                                                    }
                                                                                  ],
                                                                                  "continue_on_failure": false,
                                                                                  "display_name": "Update hash disposition in table",
                                                                                  "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                                                                  "row": [
                                                                                    {
                                                                                      "key": "disposition",
                                                                                      "type": "string",
                                                                                      "value": "Malicious"
                                                                                    }
                                                                                  ],
                                                                                  "rows": {
                                                                                    "rows_matching_criteria": true,
                                                                                    "where_clause": "type == 'url' AND value == '$activity.definition_activity_01LY1R0D77QK160s8Co3vNqdtPntKHCfvTZ.input.source_array[@].value$'"
                                                                                  },
                                                                                  "skip_execution": false
                                                                                },
                                                                                "object_type": "definition_activity"
                                                                              }
                                                                            ]
                                                                          }
                                                                        ]
                                                                      }
                                                                    ]
                                                                  },
                                                                  {
                                                                    "unique_name": "definition_activity_01LY1SI1899F73LptVbjVVZzfbzQBfqnt50",
                                                                    "name": "Condition Branch",
                                                                    "title": "No",
                                                                    "type": "logic.condition_block",
                                                                    "base_type": "activity",
                                                                    "properties": {
                                                                      "condition": {
                                                                        "left_operand": "$activity.definition_activity_01LY1RZU1L5DB32Sytnw6HU96fQNHAu1KyH.output.succeeded$",
                                                                        "operator": "eq",
                                                                        "right_operand": false
                                                                      },
                                                                      "continue_on_failure": false,
                                                                      "display_name": "No",
                                                                      "skip_execution": false
                                                                    },
                                                                    "object_type": "definition_activity",
                                                                    "actions": [
                                                                      {
                                                                        "unique_name": "definition_activity_01LY1SJBJQ0YO3jrIZMANBeZBC7LMAvPPv0",
                                                                        "name": "Set Variables",
                                                                        "title": "Update ticket text",
                                                                        "type": "core.set_multiple_variables",
                                                                        "base_type": "activity",
                                                                        "properties": {
                                                                          "continue_on_failure": false,
                                                                          "display_name": "Update ticket text",
                                                                          "skip_execution": false,
                                                                          "variables_to_update": [
                                                                            {
                                                                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Failed to extract threat score from analysis results"
                                                                            }
                                                                          ]
                                                                        },
                                                                        "object_type": "definition_activity"
                                                                      }
                                                                    ]
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "unique_name": "definition_activity_01LY1SKKVT4IJ0QyMvZ09OrCMmdsv0mHEWh",
                                                            "name": "Condition Branch",
                                                            "title": "No",
                                                            "type": "logic.condition_block",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "condition": {
                                                                "left_operand": "$activity.definition_activity_01LY1RSZRMDJY6vC2rll6G0F7YfI9uO8wFZ.output.succeeded$",
                                                                "operator": "eq",
                                                                "right_operand": false
                                                              },
                                                              "continue_on_failure": false,
                                                              "display_name": "No",
                                                              "skip_execution": false
                                                            },
                                                            "object_type": "definition_activity",
                                                            "actions": [
                                                              {
                                                                "unique_name": "definition_activity_01LY1SM3K9FEO6w1BKeoVU5zN2txEliBes6",
                                                                "name": "Set Variables",
                                                                "title": "Update ticket text",
                                                                "type": "core.set_multiple_variables",
                                                                "base_type": "activity",
                                                                "properties": {
                                                                  "continue_on_failure": false,
                                                                  "display_name": "Update ticket text",
                                                                  "skip_execution": false,
                                                                  "variables_to_update": [
                                                                    {
                                                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                                      "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Failed to submit URL to Threat Grid for analysis"
                                                                    }
                                                                  ]
                                                                },
                                                                "object_type": "definition_activity"
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LY1SN40TD4H4HgyYvjyvEZejW4K3hdmhu",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].is_email_type$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1SOEVDIHL3YscskidpOHaiNiJ13jnL7",
                        "name": "Threat Response v2 - Get Deliberate Verdict",
                        "title": "Threat Response v2 - Get Deliberate Verdict",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Threat Response v2 - Get Deliberate Verdict",
                          "input": {
                            "variable_workflow_01KXGQWL4TDTE02Mxh65PHxstnnK3wTcCF2": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97H320BJJq8BSrkJsjlg2SIHC92$",
                            "variable_workflow_01KXGQWL4THYI5hexa4Ip4LW0UZIJhk4ejv": "sha256",
                            "variable_workflow_01KXGQWL4TLPV5NbUAlHHHQUcco57lEijh9": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LY1SQOJIOQB00OSFh9faYTVldhdCsjr59",
                        "name": "Add Row to Table",
                        "title": "Add hash to observable table",
                        "type": "core.addrowtotable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Add hash to observable table",
                          "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                          "row": [
                            {
                              "key": "type",
                              "type": "string",
                              "value": "sha256"
                            },
                            {
                              "key": "value",
                              "type": "string",
                              "value": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$"
                            },
                            {
                              "key": "disposition",
                              "type": "string",
                              "value": "$activity.definition_activity_01LY1SOEVDIHL3YscskidpOHaiNiJ13jnL7.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LY1STPFGSLL1LuTSZtk9u6mE4TxR9q6bD",
                        "name": "Set Variables",
                        "title": "Update ticket text",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update ticket text",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Parsing attachment as a file\n* Threat Response disposition for attachment file hash: $activity.definition_activity_01LY1SOEVDIHL3YscskidpOHaiNiJ13jnL7.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01LY1SV068TLP53K5B9niFMnUegj0HzFlPZ",
                        "name": "Condition Block",
                        "title": "What was the disposition?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "What was the disposition?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LY1SW9BDP0M29fD0bQ3Qd6NvtSiUvUOJG",
                            "name": "Condition Branch",
                            "title": "Unknown",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LY1SOEVDIHL3YscskidpOHaiNiJ13jnL7.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$",
                                "operator": "eqi",
                                "right_operand": "Unknown"
                              },
                              "continue_on_failure": false,
                              "display_name": "Unknown",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LY1SXZXX0IX5gRGxTfgvRsdyDi0SaNEir",
                                "name": "Execute Python Script",
                                "title": "Check file type",
                                "type": "python3.script",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Check file type",
                                  "script": "import sys,re\n\nfileName = sys.argv[1]\n\nfileSupported = False\n\nmatches = re.search(r\"\\.(DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|PDF|XML|XPS)$\", fileName, re.IGNORECASE)\n\nif matches:\n\tfileSupported = True",
                                  "script_arguments": [
                                    "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_name$"
                                  ],
                                  "script_queries": [
                                    {
                                      "script_query": "fileSupported",
                                      "script_query_name": "fileSupported",
                                      "script_query_type": "boolean"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LY1SZIIYHSW6Ske0GO6oH50HFzDI5V2v3",
                                "name": "Condition Block",
                                "title": "Is this file type supported for Threat Grid?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Is this file type supported for Threat Grid?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LY1T0R5RA77461s5lm1Hoekjf1ztIFW7V",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LY1SXZXX0IX5gRGxTfgvRsdyDi0SaNEir.output.script_queries.fileSupported$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1T2Z9VVD429piAlr5NzKWWeWmWv88EJ",
                                        "name": "Set Variables",
                                        "title": "Update ticket text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update ticket text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Unable to inspect attachment with Threat Grid (file type not supported)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1T42U131S3aG1CSEjUto3rF9H3WoYjE",
                                        "name": "Continue",
                                        "title": "Skip this attachment",
                                        "type": "logic.continue",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Skip this attachment",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01LY1T6B4Q3KZ4zsdcqN4gNeANU5lPpm2nv",
                                "name": "Threat Grid v2 - Get Samples by File Hash",
                                "title": "Threat Grid v2 - Get Samples by File Hash",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Threat Grid v2 - Get Samples by File Hash",
                                  "input": {
                                    "variable_workflow_01LG728NFQQ1B0w73ofaVTY1j0eCchHiq1a": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97C834pQ1bAqVN4BTXoSwf7fubr$",
                                    "variable_workflow_01LG728NFQWKU0AByukUVhxy7ZUnFvl1nBb": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$",
                                    "variable_workflow_01LG7E6RQ83DA2DnhaNSD0oBmf0W9Krw48A": "desc",
                                    "variable_workflow_01LG7FHHK92RR24Gzv0zeE3oIzT3GvwVfa8": "submitted_at",
                                    "variable_workflow_01LG8AGPD0UJ63Hi2sWL9MogjQUw2y0xOQA": "state=succ",
                                    "variable_workflow_01LG8DIBRB3070jvTPUFY95yOVUqsJoeXjI": 0,
                                    "variable_workflow_01LG8DQLC65NP0ZIA4V8zRiKvfTARgxPBWZ": 1
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ThreatGrid_Target"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01LG728NY19RR7dSxgZ5Pjjk6kyokjflhvJ"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LY1T83W3ED05mVCcl9Pk3nZJF4Vu3UT1i",
                                "name": "Condition Block",
                                "title": "Was this file submitted previously?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Was this file submitted previously?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LY1T8W1ANNP0sPtGtNB2WgZSGvgiAB95F",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LY1T6B4Q3KZ4zsdcqN4gNeANU5lPpm2nv.output.variable_workflow_01LG7GH2NBMMW0caH58Nq48w9uZxFcLysdB$",
                                        "operator": "gt",
                                        "right_operand": 0
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1TA71XSEL43rutc5tUrQucDbUeBBKEI",
                                        "name": "JSONPath Query",
                                        "title": "Extract the most recent threat score",
                                        "type": "corejava.jsonpathquery",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": true,
                                          "display_name": "Extract the most recent threat score",
                                          "input_json": "$activity.definition_activity_01LY1T6B4Q3KZ4zsdcqN4gNeANU5lPpm2nv.output.variable_workflow_01LG728NFQXQK0Yx9wvpzftcQyJBmQ9gD6k$",
                                          "jsonpath_queries": [
                                            {
                                              "jsonpath_query": "$.data.items[0].item.analysis.threat_score",
                                              "jsonpath_query_name": "threat_score",
                                              "jsonpath_query_type": "integer"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01LY1TC86HUBS7PYsczOqC23Zi8vv01QAlR",
                                        "name": "Condition Block",
                                        "title": "Were we able to get a threat score?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Were we able to get a threat score?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01LY1TDYMNI534gzpUFg37TcHiwAMStAELp",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01LY1TA71XSEL43rutc5tUrQucDbUeBBKEI.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": true
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LY1TGH6KLIZ1Yip1B68wWo1YAGrRv5omv",
                                                "name": "Set Variables",
                                                "title": "Set local variable",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Set local variable",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$",
                                                      "variable_value_new": "$activity.definition_activity_01LY1TA71XSEL43rutc5tUrQucDbUeBBKEI.output.jsonpath_queries.threat_score$"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01LY1THJLENC85hLubK3HdYfmCwY2Xx5MZc",
                                            "name": "Condition Branch",
                                            "title": "No",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01LY1TA71XSEL43rutc5tUrQucDbUeBBKEI.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "No",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01LY1TITNUU5Q05Bb2GpBoJn9I8F7T2ZnL1",
                                                "name": "Set Variables",
                                                "title": "Update ticket text",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Update ticket text",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                      "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Failed to extract threat score from analysis results"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01LY1TJUCT3AC7CFdVMnmnFWLzKGycwZal7",
                                                "name": "Continue",
                                                "title": "Continue",
                                                "type": "logic.continue",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Continue",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LY1TL35IP7P4yTq63yCxLBovONeDHAirA",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01LY1T6B4Q3KZ4zsdcqN4gNeANU5lPpm2nv.output.variable_workflow_01LG7GH2NBMMW0caH58Nq48w9uZxFcLysdB$",
                                        "operator": "eq",
                                        "right_operand": 0
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1TLVJUM8G2jpGFSeh6F8QZ4QOSW6ijt",
                                        "name": "Group",
                                        "title": "Send file to Threat Grid for analysis",
                                        "type": "logic.group",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Send file to Threat Grid for analysis",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01LY1TPB1JLJR7g1NAj0jdivEHzjN7xl5kv",
                                            "name": "Threat Grid v2 - Submit File",
                                            "title": "Threat Grid v2 - Submit File",
                                            "type": "workflow.atomic_workflow",
                                            "base_type": "subworkflow",
                                            "properties": {
                                              "continue_on_failure": true,
                                              "display_name": "Threat Grid v2 - Submit File",
                                              "input": {
                                                "variable_workflow_01KXH6AHLNG5E2StV8uxZASafbfe8mYXeRR": "$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_path$",
                                                "variable_workflow_01KXH6TVT5XLK7DzxlR3iNSC9LSlGmrin10": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97C834pQ1bAqVN4BTXoSwf7fubr$",
                                                "variable_workflow_01KXH7QUEDAJC6KvdIWyuQ6Kt5Ua7KlhROv": "phishing,securex",
                                                "variable_workflow_01LEFJ8WY85LM6va7vryqG1SDZFBY27gWay": true,
                                                "variable_workflow_01LEHUVZUJIVG1z5EfrfjDHEX8IL7q5k1Hd": true,
                                                "variable_workflow_01LEHY1S38QYK7ObKJLB8KnKUlYvPWTANta": "default",
                                                "variable_workflow_01LEHZ5BA9I8Z1pQhnpLgTw4pO7zNB7LEme": "",
                                                "variable_workflow_01LEI08N0GUTB23y2Jc45PTVMqNJRnJEKZV": 2
                                              },
                                              "runtime_user": {
                                                "target_default": true
                                              },
                                              "skip_execution": false,
                                              "target": {
                                                "override_workflow_target_group_criteria": true,
                                                "target_group": {
                                                  "run_on_all_targets": false,
                                                  "use_criteria": {
                                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                    "conditions": [
                                                      {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ThreatGrid_Target"
                                                      }
                                                    ]
                                                  }
                                                }
                                              },
                                              "workflow_id": "definition_workflow_01KXH2YWVULRP7kaaTT7ATl62qbAEXE5cpn"
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01LY1TS90Y33C3DNDgSYZBV7ifabImL7KSW",
                                            "name": "Set Variables",
                                            "title": "Update ticket text",
                                            "type": "core.set_multiple_variables",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Update ticket text",
                                              "skip_execution": false,
                                              "variables_to_update": [
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                  "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* File submitted to Threat Grid with sample ID: [$activity.definition_activity_01LY1TPB1JLJR7g1NAj0jdivEHzjN7xl5kv.output.variable_workflow_01KXHAWJ5E4BA21ZS32fdAN6IeawizRgPN8$](https://panacea.threatgrid.com/mask/samples/$activity.definition_activity_01LY1TPB1JLJR7g1NAj0jdivEHzjN7xl5kv.output.variable_workflow_01KXHAWJ5E4BA21ZS32fdAN6IeawizRgPN8$)"
                                                },
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97OQ83VMfDql50Rss65dzCVukqZ$",
                                                  "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97OQ83VMfDql50Rss65dzCVukqZ$+1"
                                                }
                                              ]
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01LY1TUHCQB4X2sU1uM0pAhS1QNFdLnDVy7",
                                            "name": "Condition Block",
                                            "title": "Was the file analyzed successfully?",
                                            "type": "logic.if_else",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Was the file analyzed successfully?",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01LY1TW005FYI5N5gXYCEUkh1gjC5TGxMdh",
                                                "name": "Condition Branch",
                                                "title": "Yes",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LY1TPB1JLJR7g1NAj0jdivEHzjN7xl5kv.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": true
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "Yes",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LY1TX0BSJ570K1VSCbgf3DceOZ7ZoFvxt",
                                                    "name": "JSONPath Query",
                                                    "title": "Extract the threat score",
                                                    "type": "corejava.jsonpathquery",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "continue_on_failure": true,
                                                      "display_name": "Extract the threat score",
                                                      "input_json": "$activity.definition_activity_01LY1TPB1JLJR7g1NAj0jdivEHzjN7xl5kv.output.variable_workflow_01LEFKI6ZT38G6ATipS7OfdT2qS41jpF2Lx$",
                                                      "jsonpath_queries": [
                                                        {
                                                          "jsonpath_query": "$.threat.threat_score",
                                                          "jsonpath_query_name": "threat_score",
                                                          "jsonpath_query_type": "integer"
                                                        }
                                                      ],
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01LY1TZ1OIES24C3CNWGChTwqwZvPIRcY8B",
                                                    "name": "Condition Block",
                                                    "title": "Were we able to get a threat score?",
                                                    "type": "logic.if_else",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Were we able to get a threat score?",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "blocks": [
                                                      {
                                                        "unique_name": "definition_activity_01LY1U0BFM3U268H3j07pyaPUZVwZeN5KzC",
                                                        "name": "Condition Branch",
                                                        "title": "Yes",
                                                        "type": "logic.condition_block",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "condition": {
                                                            "left_operand": "$activity.definition_activity_01LY1TX0BSJ570K1VSCbgf3DceOZ7ZoFvxt.output.succeeded$",
                                                            "operator": "eq",
                                                            "right_operand": true
                                                          },
                                                          "continue_on_failure": false,
                                                          "display_name": "Yes",
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity",
                                                        "actions": [
                                                          {
                                                            "unique_name": "definition_activity_01LY1U1UJPK410V4okkTsuCUH37kBIahnx9",
                                                            "name": "Set Variables",
                                                            "title": "Set local variable",
                                                            "type": "core.set_multiple_variables",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "continue_on_failure": false,
                                                              "display_name": "Set local variable",
                                                              "skip_execution": false,
                                                              "variables_to_update": [
                                                                {
                                                                  "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$",
                                                                  "variable_value_new": "$activity.definition_activity_01LY1TX0BSJ570K1VSCbgf3DceOZ7ZoFvxt.output.jsonpath_queries.threat_score$"
                                                                }
                                                              ]
                                                            },
                                                            "object_type": "definition_activity"
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01LY1U437S38C5wm2s1sFFVl46CTxk3pa8l",
                                                        "name": "Condition Branch",
                                                        "title": "No",
                                                        "type": "logic.condition_block",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "condition": {
                                                            "left_operand": "$activity.definition_activity_01LY1TX0BSJ570K1VSCbgf3DceOZ7ZoFvxt.output.succeeded$",
                                                            "operator": "eq",
                                                            "right_operand": false
                                                          },
                                                          "continue_on_failure": false,
                                                          "display_name": "No",
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity",
                                                        "actions": [
                                                          {
                                                            "unique_name": "definition_activity_01LY1U4WKQKAF58s5chizsDztNxcv23HPqT",
                                                            "name": "Set Variables",
                                                            "title": "Update ticket text",
                                                            "type": "core.set_multiple_variables",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "continue_on_failure": false,
                                                              "display_name": "Update ticket text",
                                                              "skip_execution": false,
                                                              "variables_to_update": [
                                                                {
                                                                  "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                                  "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Failed to extract threat score from analysis results"
                                                                }
                                                              ]
                                                            },
                                                            "object_type": "definition_activity"
                                                          },
                                                          {
                                                            "unique_name": "definition_activity_01LY1U64WPXNJ43zMWrcVEeVt2y6ByG9YWj",
                                                            "name": "Continue",
                                                            "title": "Continue",
                                                            "type": "logic.continue",
                                                            "base_type": "activity",
                                                            "properties": {
                                                              "continue_on_failure": false,
                                                              "display_name": "Continue",
                                                              "skip_execution": false
                                                            },
                                                            "object_type": "definition_activity"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01LY1U7MUYGXH31Cnqqn5o5xKLjsPcDDA1Z",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01LY1TPB1JLJR7g1NAj0jdivEHzjN7xl5kv.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": false
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "No",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01LY1U960UV523csJDJq9rIWnqffgAi0MvU",
                                                    "name": "Set Variables",
                                                    "title": "Update ticket text",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Update ticket text",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                                          "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* Failed to submit file to Threat Grid for analysis"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01LY1UB4Y3G2D3Ugr70vIniTKJMqyRrPf6D",
                                                    "name": "Continue",
                                                    "title": "Continue",
                                                    "type": "logic.continue",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Continue",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01LY1UBP1MWRI38exQqm4CSPok4gfJB5zQ0",
                                "name": "Set Variables",
                                "title": "Update ticket text",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Update ticket text",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                                      "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$\n* File threat score: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LY1UD79TJFH3S2CoZ80MXKgxc9VAlqvWu",
                                "name": "Condition Block",
                                "title": "Was the file a threat?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Was the file a threat?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01LY1UEXKDG3I0NvYP5ZBZstEPbYZSuaARp",
                                    "name": "Condition Branch",
                                    "title": "Less than 70",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$",
                                        "operator": "lt",
                                        "right_operand": 70
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Less than 70",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1UG7QD3PT3g7CCggruIxSye7xtyXyn9",
                                        "name": "Update Row in Table",
                                        "title": "Update hash disposition in table",
                                        "type": "core.updaterowintable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "disposition",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Update hash disposition in table",
                                          "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                          "row": [
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "Clean"
                                            }
                                          ],
                                          "rows": {
                                            "rows_matching_criteria": true,
                                            "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$'"
                                          },
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LY1UIHFF4UB3TLWGdbxxzAiu2g94xVO1W",
                                    "name": "Condition Branch",
                                    "title": "Suspicious (70-89)",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": {
                                          "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$",
                                          "operator": "gte",
                                          "right_operand": 70
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$",
                                          "operator": "lt",
                                          "right_operand": 90
                                        }
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Suspicious (70-89)",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1UJ99UU1R1JkEJw5dihe0rbCZL7JPTB",
                                        "name": "Update Row in Table",
                                        "title": "Update hash disposition in table",
                                        "type": "core.updaterowintable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "disposition",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Update hash disposition in table",
                                          "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                          "row": [
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "Suspicious"
                                            }
                                          ],
                                          "rows": {
                                            "rows_matching_criteria": true,
                                            "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$'"
                                          },
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01LY1UKTF6UU707xOot70jKyRusw3JUp5sy",
                                    "name": "Condition Branch",
                                    "title": "Malicious (90 or more)",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97INA1rbLzjcqNmZFIavOkYpy6Z$",
                                        "operator": "gte",
                                        "right_operand": 90
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Malicious (90 or more)",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01LY1ULL62UVD62foInIPH8E6HddldkVgQU",
                                        "name": "Update Row in Table",
                                        "title": "Update hash disposition in table",
                                        "type": "core.updaterowintable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "disposition",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Update hash disposition in table",
                                          "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                          "row": [
                                            {
                                              "key": "disposition",
                                              "type": "string",
                                              "value": "Malicious"
                                            }
                                          ],
                                          "rows": {
                                            "rows_matching_criteria": true,
                                            "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$'"
                                          },
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LY1UNL11FX54nG8FrG9vzBLJ8FpaWzxSF",
                            "name": "Condition Branch",
                            "title": "Anything besides unknown",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LY1SOEVDIHL3YscskidpOHaiNiJ13jnL7.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$",
                                "operator": "ne",
                                "right_operand": "Unknown"
                              },
                              "continue_on_failure": false,
                              "display_name": "Anything besides unknown",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LY1UPBUZRAP30zSm5ov5VGgeB1HhcsKZC",
                                "name": "Update Row in Table",
                                "title": "Update hash disposition in table",
                                "type": "core.updaterowintable",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "columns": [
                                    {
                                      "column_name": "disposition",
                                      "column_type": "string"
                                    }
                                  ],
                                  "continue_on_failure": false,
                                  "display_name": "Update hash disposition in table",
                                  "input_table": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$",
                                  "row": [
                                    {
                                      "key": "disposition",
                                      "type": "string",
                                      "value": "$activity.definition_activity_01LY1SOEVDIHL3YscskidpOHaiNiJ13jnL7.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                                    }
                                  ],
                                  "rows": {
                                    "rows_matching_criteria": true,
                                    "where_clause": "type == 'sha256' AND value == '$activity.definition_activity_01LY1QA3I91NV3LmjIvHOZto5xQMYRQbEiO.input.source_array[@].file_hash$'"
                                  },
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1URLDBTCQ38YIifE27DtbyskgAdS7FG",
        "name": "Group",
        "title": "Build the observable statistics",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Build the observable statistics",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LY1UU2WTAWA7Ckj1M1fXnCbTxygPN6nD4",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1UW3WNROE5qJfDzuAYXOGRNxViyNVxu",
                "name": "Condition Block",
                "title": "What was the disposition?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "What was the disposition?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01LY1UX54J7041KT4wwUNnP8BNbKmQMDcAS",
                    "name": "Condition Branch",
                    "title": "Suspicious",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LY1UU2WTAWA7Ckj1M1fXnCbTxygPN6nD4.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Suspicious"
                      },
                      "continue_on_failure": false,
                      "display_name": "Suspicious",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1UY65L01613oayVs2amXB2BqpGr5x2S",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$",
                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LY1UZOL1ZTB2Bs2sEWDrXQOhbFeNm88RT",
                    "name": "Condition Branch",
                    "title": "Malicious",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LY1UU2WTAWA7Ckj1M1fXnCbTxygPN6nD4.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Malicious"
                      },
                      "continue_on_failure": false,
                      "display_name": "Malicious",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1V1XUWIMK7RUOfK0SlCVKzoOXJtP6Sm",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$",
                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LY1V3OWTB340KMLGZKDnhCsOYrm3qp5SA",
                    "name": "Condition Branch",
                    "title": "Unknown",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LY1UU2WTAWA7Ckj1M1fXnCbTxygPN6nD4.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Unknown"
                      },
                      "continue_on_failure": false,
                      "display_name": "Unknown",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1V65ZOAO07GrTKKoyKqZxAzVCKrgkYj",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6$",
                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LY1V7X1IZKF1IvbsrzXnZuxuCuigHPFUG",
                    "name": "Condition Branch",
                    "title": "Clean",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01LY1UU2WTAWA7Ckj1M1fXnCbTxygPN6nD4.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "Clean",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1V8GAJFBJ5tgq0xHwlouqsHmfQWvyU8",
                        "name": "Set Variables",
                        "title": "Set local variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h$",
                              "variable_value_new": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1VBLK1OUB14ogdfCDGTP4Q4KmPE5Uu9",
        "name": "Condition Block",
        "title": "Was there anything suspicious or malicious?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Was there anything suspicious or malicious?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01LY1VD2M8IEE5IHjUTbHMoKkEy1JH27pyG",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$",
                  "operator": "gt",
                  "right_operand": 0
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$",
                  "operator": "gt",
                  "right_operand": 0
                }
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LY1VESW0NGU0ow1kaZ9FhbPzc11zUw73t",
                "name": "Group",
                "title": "Truncate the ticket text if needed",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Truncate the ticket text if needed",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1VG2FSL7N0QXYwPkB7WyTJX4Ik0x1Dm",
                    "name": "Execute Python Script",
                    "title": "Truncate the ticket text",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Truncate the ticket text",
                      "script": "import sys\n\n# Placeholder for the output text\ntrimmedText = \"\"\n\n# Check if we need to truncate\nif len(sys.argv[1]) \u003c= 4500:\n\ttrimmedText = sys.argv[1]\nelse:\n\t# Loop through each line of input\n\tfor line in sys.argv[1].split(\"\\n\"):\n\t\t# Is the message too long?\n\t\tif len(trimmedText) \u003e 4500:\n\t\t\t# Yes, so add a warning and stop the look\n\t\t\ttrimmedText = trimmedText + \"\\nNOTE: Additional investigation information was truncated due to message length limits\"\n\t\t\tbreak\n\t\telse:\n\t\t\t# No, so keep appending\n\t\t\ttrimmedText = trimmedText + \"\\n\" + line",
                      "script_arguments": [
                        "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "trimmedText",
                          "script_query_name": "trimmedText",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LY1VIAR38KT0zZJtAsYXnW5obfBpbGvOl",
                    "name": "Set Variables",
                    "title": "Set local variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                          "variable_value_new": "$activity.definition_activity_01LY1VG2FSL7N0QXYwPkB7WyTJX4Ik0x1Dm.output.script_queries.trimmedText$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LY1VKBF6BR178CsL2cySOqQMsKQjHxPF7",
                "name": "Group",
                "title": "Generate Threat Response objects",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Generate Threat Response objects",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1VMK4P2DB3OeaXYSBtb0YJIxp19Pzfc",
                    "name": "Threat Response v2 - Generate Access Token",
                    "title": "Threat Response v2 - Generate Access Token",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Generate Access Token",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "CTR_For_Access_Token"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LY1VOKIVCWZ6gun8hQeoomz4Gq8qKE5CP",
                    "name": "For Each",
                    "title": "For each observable",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For each observable",
                      "skip_execution": false,
                      "source_array": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97RPO7f9aoOzJUzAQ53HH0ulLDh$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01LY1VQS4PJYQ21ComWJSftyIA6zjTiuwd3",
                        "name": "Condition Block",
                        "title": "What is its disposition?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "What is its disposition?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01LY1VSIFY8RN5QzbW0UlzjwMuG4rAD31Wu",
                            "name": "Condition Branch",
                            "title": "Clean",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LY1VOKIVCWZ6gun8hQeoomz4Gq8qKE5CP.input.source_array[@].disposition$",
                                "operator": "eqi",
                                "right_operand": "Clean"
                              },
                              "continue_on_failure": false,
                              "display_name": "Clean",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LY1VU8LD36U6Cx38WcBMLN2uB6J51DyeM",
                                "name": "Continue",
                                "title": "Skip this observable",
                                "type": "logic.continue",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Skip this observable",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01LY1VV99TLP37c1AZ7iFRuHq1ITJXLTYnh",
                            "name": "Condition Branch",
                            "title": "Not Clean",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01LY1VOKIVCWZ6gun8hQeoomz4Gq8qKE5CP.input.source_array[@].disposition$",
                                "operator": "ne",
                                "right_operand": "Clean"
                              },
                              "continue_on_failure": false,
                              "display_name": "Not Clean",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01LY1VWRPPLEH6hi7PjTjfOkxrPi3hKN05F",
                                "name": "Execute Python Script",
                                "title": "Add observable to JSON list",
                                "type": "python3.script",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": false,
                                  "display_name": "Add observable to JSON list",
                                  "script": "import sys, json\n\nexistingObservables = json.loads(sys.argv[1])\nobservableType = sys.argv[2]\nobservableValue = sys.argv[3]\n\nexistingObservables.append({ \"type\": observableType, \"value\": observableValue })\n\nobservableJson = json.dumps(existingObservables)",
                                  "script_arguments": [
                                    "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97KAB3Z2MbMw91M7eyJlVUiN079$",
                                    "$activity.definition_activity_01LY1VOKIVCWZ6gun8hQeoomz4Gq8qKE5CP.input.source_array[@].type$",
                                    "$activity.definition_activity_01LY1VOKIVCWZ6gun8hQeoomz4Gq8qKE5CP.input.source_array[@].value$"
                                  ],
                                  "script_queries": [
                                    {
                                      "script_query": "observableJson",
                                      "script_query_name": "observableJson",
                                      "script_query_type": "string"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01LY1VYJFXM9L5tyGIl4rfo1Vv48meW2vBm",
                                "name": "Set Variables",
                                "title": "Set observable variable with output",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set observable variable with output",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97KAB3Z2MbMw91M7eyJlVUiN079$",
                                      "variable_value_new": "$activity.definition_activity_01LY1VWRPPLEH6hi7PjTjfOkxrPi3hKN05F.output.script_queries.observableJson$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LY1W1RQ6V7C3ntzVAVnEOQmJ3mjURWbon",
                    "name": "Threat Response v2 - Create Casebook",
                    "title": "Threat Response v2 - Create Casebook",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Casebook",
                      "input": {
                        "variable_workflow_01KVOGF4J481T6SCd7uh5fW7n47Q712nleJ": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97KAB3Z2MbMw91M7eyJlVUiN079$",
                        "variable_workflow_01KVOGF4J4FZC0jmaR42b1FbIzVZA19KbYL": "A phishing investigation was conducted in response to an email arriving in the phishing mailbox.\n\nObservable statistics:\n* Clean: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h$\n* Suspicious: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$\n* Malicious: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$\n* Unknown: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6$\n\n$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                        "variable_workflow_01KVOGF4J4IG81TQKFjqzLlnFJwiiNwXwSq": "$activity.definition_activity_01LY1VMK4P2DB3OeaXYSBtb0YJIxp19Pzfc.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KVOGF4J4JL52xC9ZXdjYwHt2SvRYkArli": "Phishing Investigation for \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\"",
                        "variable_workflow_01KVOMXV9ERSV0M9j1WarflgSG8r5SpZ8b5": "Phishing Investigation for \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\"",
                        "variable_workflow_01LFBYQJV9FZA2THdEQrMftLyGiiHP65nUq": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LY1W6ZXNDSS1cP8FVgTriKV33uhsb10vV",
                    "name": "Threat Response v2 - Create Incident",
                    "title": "Threat Response v2 - Create Incident",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Incident",
                      "input": {
                        "variable_workflow_01KVVWMAKJ5X54vaAuNkKq259VyiO5JCeuC": "$activity.definition_activity_01LY1VMK4P2DB3OeaXYSBtb0YJIxp19Pzfc.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KVVWMAKJ9HX4TuMb2g74UqzpRLRxjwlwm": "Phishing Investigation for \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\"",
                        "variable_workflow_01KVVWMAKJBSF1Fxv8uLSCRGpOJCxkue4OH": "A phishing investigation was conducted in response to an email arriving in the phishing mailbox.\n\nObservable statistics:\n* Clean: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h$\n* Suspicious: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$\n* Malicious: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$\n* Unknown: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6$",
                        "variable_workflow_01KWIVDCZ7VJU1t9jPK4nZnnwHqnllu7dJm": "New",
                        "variable_workflow_01KWIVQVGZKUC0vUPbm3oCvqsYVV036tieP": "High",
                        "variable_workflow_01LFBWLGJNHPS450Wh1dwGf1Xqot6KHUTwY": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LY1WAHSBC5U2RGwHYBysl842DkmYaWjGp",
                    "name": "Threat Response v2 - Create Relationship",
                    "title": "Threat Response v2 - Create Relationship",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Relationship",
                      "input": {
                        "variable_workflow_01KWID476NLS63mQo7De2Wk9Q1WAJb0dJXe": "$activity.definition_activity_01LY1VMK4P2DB3OeaXYSBtb0YJIxp19Pzfc.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KWID476NNBL4xUNZ1ze05KmIr6MTOd2tf": "related-to",
                        "variable_workflow_01KWID476NOW27YCzfBvT6jlpfoo4jDNQoS": "",
                        "variable_workflow_01KWID476NRV53BPxHqiyGzSy3hiS50IIYt": "",
                        "variable_workflow_01KWIOPHDZHRM2nxENJ5E3iBUjDizSHzujd": "$activity.definition_activity_01LY1W1RQ6V7C3ntzVAVnEOQmJ3mjURWbon.output.variable_workflow_01KVOGF4J4HBH1AEO1b5YnhSpqUnFihUeXS$",
                        "variable_workflow_01KWIP24K2A5P6ag8merXYIrzb5KHnOSzU3": "$activity.definition_activity_01LY1W6ZXNDSS1cP8FVgTriKV33uhsb10vV.output.variable_workflow_01KVVWMAKJDWL0w7z086xbnRNZMwGcpxweP$",
                        "variable_workflow_01LFBZWJ98ZH426APtwKiW7OM9nNQMfT7IA": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LY1WEP3CFJW7j3CfIdIol85O2J47yf86G",
                    "name": "Threat Response v2 - Create Sighting",
                    "title": "Threat Response v2 - Create Sighting",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Sighting",
                      "input": {
                        "variable_workflow_01KWI6XBXC36X5fDp4P3C4W39e3ii12zcYI": "User targeted by a phishing attempt",
                        "variable_workflow_01KWI6XBXC8MT4PhPchVEzUFUYhgJ5L37zI": "User targeted by a phishing attempt",
                        "variable_workflow_01KWI6XBXCB6Z7FBz7mVAbr2nQMRfJrB9h4": "$activity.definition_activity_01LY1VMK4P2DB3OeaXYSBtb0YJIxp19Pzfc.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KWI8HQQALI75l9Rdg4OpEokFpKs35ZysU": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97KAB3Z2MbMw91M7eyJlVUiN079$",
                        "variable_workflow_01KWI98GQEUY83GabUEPdfqY7XaeitLae2F": "Medium",
                        "variable_workflow_01KWIBOK8V9E16FTFfn7IAUK0P0mHgXZrGT": "[{\"type\":\"user\",\"observables\":[{\"type\":\"email\",\"value\":\"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.sender$\"}],\"observed_time\":{\"start_time\":\"$activity.definition_activity_01LY1W1RQ6V7C3ntzVAVnEOQmJ3mjURWbon.output.end_time$\"}}]",
                        "variable_workflow_01KWIYHA5ADVS34NX0EPNpeSYNtUj522l8P": "High",
                        "variable_workflow_01LFBXTCC6NTI4FkW9IYQZb6HAYE8EtHfl7": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWI6XE6K5YD5I6K2wZF5Vp0M9FyXUl34y"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01LY1WI5LYACZ2F2SoiSc9vB9ZoUtIcVLH7",
                    "name": "Threat Response v2 - Create Relationship",
                    "title": "Threat Response v2 - Create Relationship",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Relationship",
                      "input": {
                        "variable_workflow_01KWID476NLS63mQo7De2Wk9Q1WAJb0dJXe": "$activity.definition_activity_01LY1VMK4P2DB3OeaXYSBtb0YJIxp19Pzfc.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KWID476NNBL4xUNZ1ze05KmIr6MTOd2tf": "related-to",
                        "variable_workflow_01KWID476NOW27YCzfBvT6jlpfoo4jDNQoS": "",
                        "variable_workflow_01KWID476NRV53BPxHqiyGzSy3hiS50IIYt": "",
                        "variable_workflow_01KWIOPHDZHRM2nxENJ5E3iBUjDizSHzujd": "$activity.definition_activity_01LY1WEP3CFJW7j3CfIdIol85O2J47yf86G.output.variable_workflow_01KWI6XBXCA122ks58vY1MiMR3fTMolsjyC$",
                        "variable_workflow_01KWIP24K2A5P6ag8merXYIrzb5KHnOSzU3": "$activity.definition_activity_01LY1W6ZXNDSS1cP8FVgTriKV33uhsb10vV.output.variable_workflow_01KVVWMAKJDWL0w7z086xbnRNZMwGcpxweP$",
                        "variable_workflow_01LFBZWJ98ZH426APtwKiW7OM9nNQMfT7IA": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LY1WKGC9L5Q7JIElUB5sybO2MvjLxuH0r",
                "name": "Group",
                "title": "Send instant message to SOC",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Send instant message to SOC",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1WLQ0EV0I0orTvDTJVyLjxYwMOvmlwl",
                    "name": "Condition Block",
                    "title": "Was a Webex Teams room provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a Webex Teams room provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01LY1WMYRXWHE07Nb5FCt5SlydlGgKqWqhf",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J978UB0GW0rDQ0q6ZwbIozqLSrez$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01LY1WOYSB7DQ4GuVZkbGYrLr7hzhHEX5SG",
                            "name": "Webex Teams - Search for Room",
                            "title": "Webex Teams - Search for Room",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Webex Teams - Search for Room",
                              "input": {
                                "variable_workflow_01FHMU6RWYQWI3QFUEzjWMT7JYBcz5vquuD": "",
                                "variable_workflow_01FHMU6RWYWY822p43LeMi8Lcx89Q9jeyek": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J978UB0GW0rDQ0q6ZwbIozqLSrez$",
                                "variable_workflow_01FHMU6RWYY481TVWDm0BQ1p0rWnqak191l": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96TVX2AThbgEAM7oJ80DHG4cwEa$",
                                "variable_workflow_01FHNGCYY2O6Z0NcPmUDabszT2P4P0oqMNd": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Webex Teams"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01LY1WQZT55RJ3UJcAgvkPRNbX8ggAXCQ9d",
                            "name": "Condition Block",
                            "title": "Did we find the room?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we find the room?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01LY1WSIH1HCA4fN85U1jtV4NyvLdtbv7TD",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01LY1WOYSB7DQ4GuVZkbGYrLr7hzhHEX5SG.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01LY1WUKS224T3Sriwqtl4uXyO0FVwdLvMz",
                                    "name": "Webex Teams - Post Message to Room",
                                    "title": "Webex Teams - Post Message to Room",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Webex Teams - Post Message to Room",
                                      "input": {
                                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96TVX2AThbgEAM7oJ80DHG4cwEa$",
                                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$activity.definition_activity_01LY1WOYSB7DQ4GuVZkbGYrLr7hzhHEX5SG.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$",
                                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": " A new phishing investigation has been created in response to a user-submitted email! The sample submitted **contained malicious or suspicious** content! \\n * Email Subject: `$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97FE803NSpVZIqXxDC9ocaKNzGl$` \\n * Sender: `$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J975E40Qh11AssXDnjCRjZY0vuYd$` \\n * Recipient(s): `$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97DS07RNMVNEN6OU9o2UHuKrjRI$` \\n * Number of Attachments: $trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.attachments_count$ \\n\\n Actions: \\n * [Investigate in Threat Response](https://$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$/investigate?spid=$activity.definition_activity_01LY1W1RQ6V7C3ntzVAVnEOQmJ3mjURWbon.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$) \\n* [View Threat Response Incident](https://$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$/incidents?q=id:$activity.definition_activity_01LY1W6ZXNDSS1cP8FVgTriKV33uhsb10vV.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$)"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "Webex Teams"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LY1WXKZMN3244EO4jadfZGGn6PSvRQO2y",
                "name": "Group",
                "title": "Send email to SOC",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Send email to SOC",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1WYV8JIXW6fSYzlmIToQINEIBoa8mGn",
                    "name": "Send Email",
                    "title": "Send SOC notification",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "An email was submitted to the phishing mailbox that was found to contain malicious and/or suspicious observables.\n\nReported by: $trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.sender$\nThreat Response Incident: https://$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$/incidents?q=id:$activity.definition_activity_01LY1W6ZXNDSS1cP8FVgTriKV33uhsb10vV.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$\nThreat Response Investigation: https://$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J970QW7NtULrKrOVUQqzTSH2erDi$/investigate?spid=$activity.definition_activity_01LY1W1RQ6V7C3ntzVAVnEOQmJ3mjURWbon.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$\n\nInformation about the investigation:\n$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96WZM5JpKcE99s2HzAq9GldyFSE$",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": false,
                      "display_name": "Send SOC notification",
                      "html": false,
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "subject": "Phishing email detected",
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J9726O1FP0co3iXQcwxM6qJSipyj$"
                              }
                            ]
                          }
                        }
                      },
                      "to": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J9775I6CfsU185Y7RvyHW0qcUGEE$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1X1TSJABP3CjebB8mxLD0CTtHdKQyu0",
        "name": "Group",
        "title": "Update statistics table",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Update statistics table",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LY1X3C7ELIE2CdfBkIfkDxLwFmmBLofXC",
            "name": "Add Row to Table",
            "title": "Add row to statistics table",
            "type": "core.addrowtotable",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Add row to statistics table",
              "input_table": "$global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ.global.variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ$",
              "row": [
                {
                  "key": "observables_clean",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J973QE0gelUAZDxmM7pPNb1Ssd9h$"
                },
                {
                  "key": "observables_suspicious",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$"
                },
                {
                  "key": "observables_malicious",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$"
                },
                {
                  "key": "observables_unknown",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97APV4kN2Ckfc73xyc1OGw3mZn6$"
                },
                {
                  "key": "threatgrid_submissions",
                  "type": "integer",
                  "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97OQ83VMfDql50Rss65dzCVukqZ$"
                },
                {
                  "key": "start_time",
                  "type": "date",
                  "value": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.start_time$"
                },
                {
                  "key": "end_time",
                  "type": "date",
                  "value": "$activity.definition_activity_01LY1VBLK1OUB14ogdfCDGTP4Q4KmPE5Uu9.output.end_time$"
                },
                {
                  "key": "num_attachments",
                  "type": "integer",
                  "value": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.attachments_count$"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01LY1X55F2PCQ74IjqCuWoHdJMsTBerDbaN",
        "name": "Group",
        "title": "Notify submitter of results",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Notify submitter of results",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01LY1X66L9B5G3JQKpkIBL1CKSkSbgtH4Ww",
            "name": "Condition Block",
            "title": "Was anything suspicious or malicious?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Was anything suspicious or malicious?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01LY1X6QJOAAV2Se36MsQuB0hiDMXQpknsR",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$",
                      "operator": "gt",
                      "right_operand": 0
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$",
                      "operator": "gt",
                      "right_operand": 0
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1X7HYY3OH2cgR2JPMDUJCNHAVTrgnIx",
                    "name": "Send Email",
                    "title": "Send user update",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "Dear user-\n\nThe email you submitted for review with the subject \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\" was found to be MALICIOUS!\n\nPlease do not open the message and delete it immediately.\n\nReference ID: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.instance_id$",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": false,
                      "display_name": "Send user update",
                      "html": false,
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "subject": "Email investigation results",
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J9726O1FP0co3iXQcwxM6qJSipyj$"
                              }
                            ]
                          }
                        }
                      },
                      "to": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.sender$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01LY1X91JO34P6rvOdZ0LvL2V1RmdWWgdX1",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J97N8I6ChlJuZmfPMjbdDhxsztuR$",
                      "operator": "eq",
                      "right_operand": 0
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J96Z0R03XgOQ9DaoLl1zZlz2Zq0F$",
                      "operator": "eq",
                      "right_operand": 0
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01LY1X9U346IO3UMatbdWlQBm2OgXIe3e0m",
                    "name": "Send Email",
                    "title": "Send user update",
                    "type": "email.smtp_send_email",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "body": "Dear user-\n\nThe email you submitted for review with the subject \"$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.subject$\" was found to be safe!\n\nYou can open and read the message safely.\n\nReference ID: $workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.output.instance_id$",
                      "continue_if_one_address_valid": false,
                      "continue_on_failure": false,
                      "display_name": "Send user update",
                      "html": false,
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "subject": "Email investigation results",
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "$workflow.definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1.local.variable_workflow_01LY1P1J9726O1FP0co3iXQcwxM6qJSipyj$"
                              }
                            ]
                          }
                        }
                      },
                      "to": "$trigger.triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi.output.sender$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "triggers": {
    "triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi": {
      "workflow_id": "definition_workflow_01LY1P1JGWMRV3rmQ25lUFrMToOIF6rM7Q1",
      "name": "Phishing Mailbox",
      "title": "",
      "lowercase_name": "event.phishing_mailbox",
      "type": "event",
      "base_type": "trigger",
      "ref_id": "event_01LGC5X9EJUOC0K1s0akjTy0WxbVxkmzIxO",
      "version": "1.0.0",
      "disabled": true,
      "unique_name": "triggerevent_01LY1P87J2DNF7BO9MUo0ct28ZoPuPKwiLi",
      "object_type": "triggerevent"
    }
  },
  "events": {
    "event_01LGC5X9EJUOC0K1s0akjTy0WxbVxkmzIxO": {
      "name": "Email in Phishing Mailbox",
      "title": "Email in Phishing Mailbox",
      "type": "email.event",
      "base_type": "event",
      "object_type": "event",
      "target_id": "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le",
      "webhook_id": "",
      "version": "1.0.0",
      "properties": {
        "action": "read",
        "display_name": "Email in Phishing Mailbox",
        "download_attachments": true,
        "folder": "INBOX",
        "target_id": "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le",
        "title": "Email in Phishing Mailbox"
      },
      "unique_name": "event_01LGC5X9EJUOC0K1s0akjTy0WxbVxkmzIxO"
    }
  },
  "targets": {
    "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le": {
      "unique_name": "definition_target_01LEJ3FP5FK9L6mt0a8XrhD40jG3PC0m1le",
      "name": "Phishing Investigation Mailbox",
      "title": "Phishing Investigation Mailbox",
      "type": "email.imap_endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "Used to check for new emails that the phishing workflow needs to process",
        "display_name": "Phishing Investigation Mailbox",
        "ignore_certificate_errors": false,
        "polling_interval": 30,
        "port": 993,
        "protocol": "IMAP",
        "server": "mail.yourdomain.com",
        "tls_enabled": true
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "variables": {
    "variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ": {
      "unique_name": "variable_01LGZU2G117B63GV7agLxwrS1rDbbXrhpkZ",
      "schema_id": "tabletype_01LGZS6QD140M6f4dg0oyFeUxSf2Tzv2ngq",
      "properties": {
        "value": [
          {
            "column_data": {
              "end_time": "1900-01-01T00:00:00Z",
              "num_attachments": 0,
              "observables_clean": 0,
              "observables_malicious": 0,
              "observables_suspicious": 0,
              "observables_unknown": 0,
              "start_time": "1900-01-01T00:00:00Z",
              "threatgrid_submissions": 0
            }
          }
        ],
        "scope": "global",
        "name": "0010 - Phishing Investigation Statistics",
        "type": "datatype.table",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_01KXKQ1CSRGVL7ZpP6ogcjNI0ADUjMVnIl5": {
      "unique_name": "tabletype_01KXKQ1CSRGVL7ZpP6ogcjNI0ADUjMVnIl5",
      "data_type": "datatype.tabletype",
      "display_name": "Phishing Response - Observables",
      "columns": [
        {
          "name": "disposition",
          "title": "disposition",
          "type": "string"
        },
        {
          "is_required": true,
          "name": "type",
          "title": "type",
          "type": "string"
        },
        {
          "is_required": true,
          "name": "value",
          "title": "value",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_01LGZS6QD140M6f4dg0oyFeUxSf2Tzv2ngq": {
      "unique_name": "tabletype_01LGZS6QD140M6f4dg0oyFeUxSf2Tzv2ngq",
      "data_type": "datatype.tabletype",
      "display_name": "Phishing Response - Statistics",
      "columns": [
        {
          "name": "observables_malicious",
          "title": "observables_malicious",
          "type": "integer"
        },
        {
          "name": "observables_suspicious",
          "title": "observables_suspicious",
          "type": "integer"
        },
        {
          "name": "observables_unknown",
          "title": "observables_unknown",
          "type": "integer"
        },
        {
          "name": "start_time",
          "title": "start_time",
          "type": "date"
        },
        {
          "name": "threatgrid_submissions",
          "title": "threatgrid_submissions",
          "type": "integer"
        },
        {
          "name": "end_time",
          "title": "end_time",
          "type": "date"
        },
        {
          "name": "num_attachments",
          "title": "num_attachments",
          "type": "integer"
        },
        {
          "name": "observables_clean",
          "title": "observables_clean",
          "type": "integer"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01KXGKZ0JA96P0p7omD4IdS6zKdw5ECiofU",
    "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf",
    "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O",
    "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS",
    "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW",
    "definition_workflow_01LG728NY19RR7dSxgZ5Pjjk6kyokjflhvJ",
    "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU",
    "definition_workflow_01KXH2YWVULRP7kaaTT7ATl62qbAEXE5cpn",
    "definition_workflow_01LKD7G2VQ44P3jhvJ6wDFa1EXSJdJPmv1j",
    "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss",
    "definition_workflow_01KWI6XE6K5YD5I6K2wZF5Vp0M9FyXUl34y",
    "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
  ]
}